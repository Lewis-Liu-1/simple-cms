<?php
interface ifile_parser
{
	public function convert_keyword($s);
	public function get_css_name();
	public function is_section_finished();
}

class myfile_parser implements ifile_parser
{
	public $print;
	function  __construct()
	{
		$this->print = false;
	}
	
	public function get_css_name() {return 'section section1';}
	public function is_section_finished(){return true;}
	
	public function convert_keyword($s)
	{
		$this->print = true;
		return $s;
	}	
}

class c_file_parser extends myfile_parser
{
	public function get_css_name() {return 'section code';}

	public function convert_keyword($s)
	{
		$colors = array('main', 'printf', 'exit', 'scanf','fopen',
			'fread','fclose','malloc','switch');
		$s=$this->convert_func_name($s,$colors);
		$colors = array('#include','#define');
		$s=$this->convert_pre_defs($s,$colors);
		$colors = array('class', 'int' , 'char', 'void','long','if','else','case',
			'using','namespace');
		$s=$this->convert_keywords($s,$colors);
		$this->print = true;
		return $s;
	}

	function convert_keywords($s,$colors)
	{
		foreach ($colors as $color) 
		{
			$s=str_replace($color." ","<span style=\"color:#66f\">".$color."</span>&nbsp;",$s);	
		}
		return $s;	
	}
	
	function convert_pre_defs($s,$colors)
	{
		foreach ($colors as $color) 
		{
			$s=str_replace($color,"<span style=\"color:#660\">".$color."</span>",$s);	
		}
		return $s;	
	}

	function convert_func_name($s,$colors)
	{
		foreach ($colors as $color) 
		{
			$s=str_replace($color."(","<span style=\"color:#66f\">".$color."</span>(",$s);	
		}
		return $s;	
	}
}

class cplus_file_parser extends c_file_parser
{
	public function convert_keyword($s)
	{
		$s=parent::convert_keyword($s);
		return $s;
	}	
}
class csharp_file_parser extends c_file_parser
{
	public function convert_keyword($s)
	{
		$s=parent::convert_keyword($s);
		return $s;
	}	
}
class java_file_parser extends c_file_parser
{
	public function convert_keyword($s)
	{
		$s=parent::convert_keyword($s);
		return $s;
	}	
}

class asm_file_parser extends myfile_parser
{
	public function get_css_name() {return 'section asm';}
	public function convert_keyword($s)
	{
		$this->print=true;
		return $s;
	}	
}

class cmd_parser extends myfile_parser
{
	public function get_css_name() {return 'command';}
	public function convert_keyword($s)
	{
		$this->print=true;
		return $s;
	}	
}

class link_parser implements ifile_parser
{
	public $print;
	private $hyperlink_found;
	function  __construct()
	{
		$this->print=false;
		$this->hyperlink_found=0;
	}
			
	public function get_css_name() {return 'hyperlink';}
	public function is_section_finished(){return true;}
	public function convert_keyword($s)
	{
		$this->print=false;
		$this->hyperlink_found++;
		$s=$this->update_link($s);
		return $s;
	}	

   function update_link($s)
   {
   	$ret=$s;
   	//echo $s."->".$this->hyperlink_found."<br/>";
		switch ($this->hyperlink_found)
		{
			case 2: 
				echo "<div class=\"atlink\"><a href=\"".trim($s)."\">";
				break;
			case 3:
				echo "$s</a></div>";
				$this->hyperlink_found=0;		
				break;
		}		
	   return $ret;
   }
}

class img_parser implements ifile_parser
{
	public $print;
	private $hyperlink_found;
	function  __construct()
	{
		$this->print=false;
		$this->hyperlink_found=0;
	}
			
	public function get_css_name() {return 'hyperlink';}
	public function is_section_finished(){return true;}
	public function convert_keyword($s)
	{
		$this->print=false;
		$this->hyperlink_found++;
		$s=$this->update_link($s);
		return $s;
	}	

   function update_link($s)
   {
   	$ret=$s;
   	//echo $s."->".$this->hyperlink_found."<br/>";
		switch ($this->hyperlink_found)
		{
			case 2: 
				echo "<img src=\"".trim($s)."\"/>";
				$this->hyperlink_found=0;		
				break;
			case 3:
				//echo "$s</a></div>";
				break;
		}		
	   return $ret;
   }
}
?>